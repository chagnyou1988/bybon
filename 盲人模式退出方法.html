<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>盲人模式退出引导</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f4f4f9;
            margin: 0;
        }

        .step {
            display: none;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 80%;
            max-width: 600px;
            margin: 20px;
        }

        .current-step {
            display: block;
        }

        button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        .warning {
            color: red;
            font-weight: bold;
        }

        <style>
            /* 新增样式 */
            .progress-bar {
                width: 100%;
                height: 10px;
                background-color: #e0e0e0;
                border-radius: 5px;
                margin: 20px 0;
                overflow: hidden;
            }

            .progress {
                height: 100%;
                background-color: #007bff;
                width: 0;
                transition: width 0.3s ease;
            }

            .step {
                /* 修改原有样式 */
                animation: fadeIn 0.5s ease;
            }

            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }

            .emoji {
                font-size: 2rem;
                margin: 10px 0;
            }

            .step-content {
                text-align: center;
            }
        </style>
    </style>
    <!-- 引入 SweetAlert2 库 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
</head>

<body>
    <div id="step1" class="step current-step">
        <div class="step-content">
            <div class="emoji">👆</div>
            <h2>尝试通过侧边按键退出盲人模式</h2>
            <div class="progress-bar">
                <div class="progress" style="width: 25%"></div>
            </div>
            <button onclick="showConfirm(1)">我已连续点击侧边按键3次</button>
            <button onclick="goBack()">返回上一级</button>
        </div>
    </div>

    <div id="step2" class="step">
        <div class="step-content">
            <div class="emoji">📱</div>
            <h2>检查屏幕亮屏状态及响应</h2>
            <div class="progress-bar">
                <div class="progress" style="width: 50%"></div>
            </div>
            <button onclick="checkScreenLit()">我已点击开机键</button>
            <button onclick="goBack()">返回上一级</button>
        </div>
    </div>

    <div id="step3" class="step">
        <div class="step-content">
            <div class="emoji">👂</div>
            <h2>如果屏幕不亮请执行</h2>
            <div class="progress-bar">
                <div class="progress" style="width: 75%"></div>
            </div>
            <div id="promptCheck">
                <p class="warning">请持续点击开机键直到听到提示音（如报时或通知内容）</p>
                <button onclick="checkPromptSound()">我听到提示音了</button>
            </div>
            <div id="unlockGuide" style="display:none;">
                <p>请用三指连续敲击屏幕直至屏幕亮起</p>
                <button onclick="activateScreen()">屏幕已亮起</button>
            </div>
            <button onclick="goBack()">返回上一级</button>
        </div>
    </div>

    <div id="step4" class="step" style="display:none;">
        <div class="step-content">
            <div class="emoji">📞</div>
            <h2>寻求技术支持</h2>
            <div class="progress-bar">
                <div class="progress" style="width: 100%"></div>
            </div>
            <p>建议联系技术支持或专业人员获取帮助，联系方式：[具体联系方式]</p>
            <button onclick="askRetry()">是否需要再次尝试上述步骤？</button>
            <button onclick="goBack()">返回上一级</button>
        </div>
    </div>

    <div id="resetDiv" style="display: none;">
        <button onclick="resetProcess()">重新开始</button>
    </div>

    <script>
        let currentStep = 1;

        async function showConfirm(branch) {
            const { isConfirmed } = await Swal.fire({
                title: '是否已退出盲人模式？',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: '是',
                cancelButtonText: '否'
            });
            if (isConfirmed) {
                exitFlow();
            } else {
                // 修复分支跳转逻辑
                switch(branch) {
                    case 1:
                        currentStep = 2;
                        break;
                    case 2:
                        currentStep = 3;
                        break;
                    case 3:
                        currentStep = 4;
                        break;
                    default:
                        currentStep = 1;
                }
                showStep(currentStep);
            }
        }

        async function checkScreenLit() {
            const { isConfirmed } = await Swal.fire({
                title: '屏幕是否亮起？',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: '是',
                cancelButtonText: '否'
            });
            if (isConfirmed) {
                await Swal.fire({
                    title: '请单指滑动进入解锁页面，输入密码时每个数字需要双击',
                    icon: 'info'
                });
                const { isConfirmed: exited } = await Swal.fire({
                    title: '是否已退出盲人模式？',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: '是',
                    cancelButtonText: '否'
                });
                if (exited) {
                    exitFlow();
                } else {
                    currentStep = 1;
                    showStep(1);
                }
            } else {
                currentStep = 3;
                showStep(3);
            }
        }

        function checkPromptSound() {
            document.getElementById('promptCheck').style.display = 'none';
            document.getElementById('unlockGuide').style.display = 'block';
        }

        async function activateScreen() {
            await Swal.fire({
                title: '屏幕已亮起，请单指滑动进入解锁页面，输入密码时每个数字需要双击',
                icon: 'info'
            });
            const { isConfirmed: exited } = await Swal.fire({
                title: '是否已退出盲人模式？',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: '是',
                cancelButtonText: '否'
            });
            if (exited) {
                exitFlow();
            } else {
                // 修改为返回分支3，而不是直接跳转到分支4
                currentStep = 3;
                showStep(3);
                // 重置分支3的状态
                document.getElementById('promptCheck').style.display = 'block';
                document.getElementById('unlockGuide').style.display = 'none';
            }
        }

        async function askRetry() {
            const { isConfirmed } = await Swal.fire({
                title: '是否需要再次尝试上述步骤？',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: '是',
                cancelButtonText: '否'
            });
            if (isConfirmed) {
                currentStep = 1;
                showStep(1);
            } else {
                exitFlow();
            }
        }

        // 在showStep函数中添加进度条更新
        function showStep(stepNumber) {
            document.querySelectorAll('.step').forEach(div => {
                div.classList.remove('current-step');
            });
            const step = document.getElementById(`step${stepNumber}`);
            step.classList.add('current-step');
            
            // 更新进度条
            const progress = step.querySelector('.progress');
            progress.style.width = `${stepNumber * 25}%`;
        }

        function exitFlow() {
            Swal.fire({
                title: '操作完成！如问题仍未解决，请保持与技术支持的联系',
                icon: 'success'
            });
            document.querySelectorAll('.step').forEach(div => div.style.display = 'none');
            document.getElementById('resetDiv').style.display = 'block';
        }

        function goBack() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        function resetProcess() {
            currentStep = 1;
            // 隐藏所有步骤
            document.querySelectorAll('.step').forEach(div => {
                div.style.display = 'none';
                div.classList.remove('current-step');
            });
            // 显示第一步
            const step1 = document.getElementById('step1');
            step1.style.display = 'block';
            step1.classList.add('current-step');
            // 重置分支3的状态
            document.getElementById('promptCheck').style.display = 'block';
            document.getElementById('unlockGuide').style.display = 'none';
            // 隐藏重置按钮
            document.getElementById('resetDiv').style.display = 'none';
        }
    </script>
</body>

</html>